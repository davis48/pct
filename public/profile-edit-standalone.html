<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modifier mon profil | Plateforme Administrative</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e'
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        .gradient-text {
            background: linear-gradient(135deg, #0284c7, #0369a1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .success-message {
            animation: slideInDown 0.3s ease-out;
        }
        
        @keyframes slideInDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-white to-indigo-50 min-h-screen">
    
    <!-- INTERFACE D'ÉDITION DE PROFIL STANDALONE -->
    <section class="py-8 min-h-screen">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto">
                
                <!-- En-tête -->
                <div class="text-center mb-8 animate-fade-in">
                    <h1 class="text-3xl font-bold gradient-text mb-2">Mon profil</h1>
                    <p class="text-gray-600">Modifiez vos informations personnelles</p>
                </div>

                <!-- Message de succès (masqué par défaut) -->
                <div id="successMessage" class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6 hidden success-message">
                    <div class="flex items-center text-green-800">
                        <i class="fas fa-check-circle mr-2"></i>
                        <span id="successText">Profil mis à jour avec succès!</span>
                    </div>
                </div>

                <!-- Messages d'erreur (masqué par défaut) -->
                <div id="errorMessages" class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6 hidden">
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-circle text-red-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-red-800 mb-1">Erreurs de validation</h3>
                            <ul id="errorList" class="text-sm text-red-700 space-y-1">
                                <!-- Les erreurs seront ajoutées ici dynamiquement -->
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden animate-fade-in">
                    <div class="bg-gradient-to-r from-primary-600 to-primary-700 p-6">
                        <h2 class="text-xl font-bold text-white flex items-center">
                            <i class="fas fa-user-edit mr-3"></i>
                            Informations personnelles
                        </h2>
                    </div>
                    
                    <div class="p-8">
                        <form id="profileForm" class="space-y-8">
                            
                            <!-- Photo de profil -->
                            <div class="flex flex-col lg:flex-row lg:items-start gap-8">
                                <div class="lg:w-1/3">
                                    <div class="text-center">
                                        <div class="relative inline-block mb-4">
                                            <div class="w-32 h-32 rounded-full bg-gradient-to-r from-primary-500 to-primary-600 flex items-center justify-center border-4 border-white shadow-lg" id="profilePreview">
                                                <i class="fas fa-user text-4xl text-white"></i>
                                            </div>                                            <div class="absolute bottom-0 right-0 bg-primary-600 rounded-full p-2 cursor-pointer hover:bg-primary-700 transition-colors duration-200" onclick="document.getElementById('profile_photo').click()">
                                                <i class="fas fa-camera text-white text-sm"></i>
                                            </div>
                                        </div>
                                        <input type="file" 
                                               class="hidden" 
                                               id="profile_photo" 
                                               name="profile_photo" 
                                               accept="image/*"
                                               title="Choisir une photo de profil"                                               onchange="previewImage(this)">
                                        <h3 class="text-lg font-semibold text-gray-900" id="userFullName">John Doe</h3>
                                        <p class="text-sm text-gray-500 capitalize" id="userRole">Utilisateur</p>
                                        <div id="fileStatus" class="mt-2 text-xs text-gray-400 hidden">
                                            <i class="fas fa-image mr-1"></i>
                                            <span id="fileName"></span>
                                        </div>
                                    </div>
                                </div>

                                <div class="lg:w-2/3">
                                    <div class="grid md:grid-cols-2 gap-6">
                                        <div>
                                            <label for="nom" class="block text-sm font-medium text-gray-700 mb-2">
                                                <i class="fas fa-user mr-2 text-gray-400"></i>
                                                Nom <span class="text-red-500">*</span>
                                            </label>
                                            <input type="text" 
                                                   class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                                                   id="nom" 
                                                   name="nom" 
                                                   value="Doe"
                                                   required>
                                            <p class="error-message mt-2 text-sm text-red-600 flex items-center hidden">
                                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                                <span class="error-text"></span>
                                            </p>
                                        </div>

                                        <div>
                                            <label for="prenoms" class="block text-sm font-medium text-gray-700 mb-2">
                                                <i class="fas fa-user mr-2 text-gray-400"></i>
                                                Prénoms <span class="text-red-500">*</span>
                                            </label>
                                            <input type="text" 
                                                   class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                                                   id="prenoms" 
                                                   name="prenoms" 
                                                   value="John"
                                                   required>
                                            <p class="error-message mt-2 text-sm text-red-600 flex items-center hidden">
                                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                                <span class="error-text"></span>
                                            </p>
                                        </div>

                                        <div>
                                            <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                                                <i class="fas fa-envelope mr-2 text-gray-400"></i>
                                                Email <span class="text-red-500">*</span>
                                            </label>
                                            <input type="email" 
                                                   class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                                                   id="email" 
                                                   name="email" 
                                                   value="john.doe@example.com"
                                                   required>
                                            <p class="error-message mt-2 text-sm text-red-600 flex items-center hidden">
                                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                                <span class="error-text"></span>
                                            </p>
                                        </div>

                                        <div>
                                            <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">
                                                <i class="fas fa-phone mr-2 text-gray-400"></i>
                                                Téléphone
                                            </label>
                                            <input type="tel" 
                                                   class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                                                   id="phone" 
                                                   name="phone" 
                                                   value="+225 12 34 56 78"
                                                   placeholder="+225 XX XX XX XX">
                                            <p class="error-message mt-2 text-sm text-red-600 flex items-center hidden">
                                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                                <span class="error-text"></span>
                                            </p>
                                        </div>

                                        <div>
                                            <label for="date_naissance" class="block text-sm font-medium text-gray-700 mb-2">
                                                <i class="fas fa-calendar mr-2 text-gray-400"></i>
                                                Date de naissance
                                            </label>
                                            <input type="date" 
                                                   class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                                                   id="date_naissance" 
                                                   name="date_naissance" 
                                                   value="1990-01-01">
                                            <p class="error-message mt-2 text-sm text-red-600 flex items-center hidden">
                                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                                <span class="error-text"></span>
                                            </p>
                                        </div>

                                        <div>
                                            <label for="genre" class="block text-sm font-medium text-gray-700 mb-2">
                                                <i class="fas fa-venus-mars mr-2 text-gray-400"></i>
                                                Genre
                                            </label>
                                            <select class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                                                    id="genre" 
                                                    name="genre">
                                                <option value="">Sélectionner...</option>
                                                <option value="M" selected>Masculin</option>
                                                <option value="F">Féminin</option>
                                                <option value="Autre">Autre</option>
                                            </select>
                                            <p class="error-message mt-2 text-sm text-red-600 flex items-center hidden">
                                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                                <span class="error-text"></span>
                                            </p>
                                        </div>
                                    </div>

                                    <div class="mt-6">
                                        <label for="address" class="block text-sm font-medium text-gray-700 mb-2">
                                            <i class="fas fa-home mr-2 text-gray-400"></i>
                                            Adresse
                                        </label>
                                        <textarea class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                                                  id="address" 
                                                  name="address" 
                                                  rows="3"
                                                  placeholder="Votre adresse complète...">123 Rue de la République, Abidjan, Côte d'Ivoire</textarea>
                                        <p class="error-message mt-2 text-sm text-red-600 flex items-center hidden">
                                            <i class="fas fa-exclamation-triangle mr-1"></i>
                                            <span class="error-text"></span>
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <!-- Section changement de mot de passe -->
                            <div class="border-t border-gray-200 pt-8">
                                <h3 class="text-lg font-semibold text-gray-800 mb-6 flex items-center">
                                    <i class="fas fa-lock mr-2 text-primary-600"></i>
                                    Changer le mot de passe
                                </h3>
                                
                                <div class="grid md:grid-cols-3 gap-6">
                                    <div>
                                        <label for="current_password" class="block text-sm font-medium text-gray-700 mb-2">
                                            Mot de passe actuel
                                        </label>
                                        <input type="password" 
                                               class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                                               id="current_password" 
                                               name="current_password"
                                               placeholder="Mot de passe actuel">
                                        <p class="error-message mt-2 text-sm text-red-600 flex items-center hidden">
                                            <i class="fas fa-exclamation-triangle mr-1"></i>
                                            <span class="error-text"></span>
                                        </p>
                                    </div>

                                    <div>
                                        <label for="password" class="block text-sm font-medium text-gray-700 mb-2">
                                            Nouveau mot de passe
                                        </label>
                                        <input type="password" 
                                               class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                                               id="password" 
                                               name="password"
                                               placeholder="Nouveau mot de passe">
                                        <p class="error-message mt-2 text-sm text-red-600 flex items-center hidden">
                                            <i class="fas fa-exclamation-triangle mr-1"></i>
                                            <span class="error-text"></span>
                                        </p>
                                    </div>

                                    <div>
                                        <label for="password_confirmation" class="block text-sm font-medium text-gray-700 mb-2">
                                            Confirmer le mot de passe
                                        </label>
                                        <input type="password" 
                                               class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                                               id="password_confirmation" 
                                               name="password_confirmation"
                                               placeholder="Confirmer le mot de passe">
                                        <p class="error-message mt-2 text-sm text-red-600 flex items-center hidden">
                                            <i class="fas fa-exclamation-triangle mr-1"></i>
                                            <span class="error-text"></span>
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <!-- Boutons d'action -->
                            <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-gray-200">
                                <button type="button" 
                                        onclick="window.history.back()"
                                        class="flex-1 sm:flex-none inline-flex items-center justify-center px-6 py-3 border border-gray-300 text-gray-700 bg-white hover:bg-gray-50 font-medium rounded-lg transition-all duration-300 shadow-sm hover:shadow-md">
                                    <i class="fas fa-arrow-left mr-2"></i>
                                    Retour
                                </button>
                                <button type="submit" 
                                        id="submitButton"
                                        class="flex-1 inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-primary-600 to-primary-700 text-white font-medium rounded-lg hover:from-primary-700 hover:to-primary-800 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 focus:outline-none focus:ring-4 focus:ring-primary-200">
                                    <i class="fas fa-save mr-2"></i>
                                    Mettre à jour le profil
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>        // Prévisualisation d'image
        function previewImage(input) {
            const fileStatus = document.getElementById('fileStatus');
            const fileName = document.getElementById('fileName');
            
            if (input.files && input.files[0]) {
                const file = input.files[0];
                
                // Vérifier le type de fichier
                if (!file.type.startsWith('image/')) {
                    alert('Veuillez sélectionner un fichier image valide.');
                    input.value = '';
                    fileStatus.classList.add('hidden');
                    return;
                }
                
                // Vérifier la taille du fichier (max 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    alert('Le fichier est trop volumineux. Taille maximale : 5MB.');
                    input.value = '';
                    fileStatus.classList.add('hidden');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('profilePreview');
                    preview.innerHTML = `
                        <img src="${e.target.result}" alt="Aperçu" class="w-32 h-32 rounded-full object-cover border-4 border-white shadow-lg">
                        <div class="absolute top-0 right-0 bg-green-500 rounded-full p-1">
                            <i class="fas fa-check text-white text-xs"></i>
                        </div>
                    `;
                    
                    // Afficher le nom du fichier
                    fileName.textContent = file.name;
                    fileStatus.classList.remove('hidden');
                    fileStatus.className = 'mt-2 text-xs text-green-600';
                    
                    // Ajouter une indication que le fichier a été sélectionné
                    showSuccessMessage(`Photo sélectionnée : ${file.name}`);
                }
                reader.readAsDataURL(file);
            } else {
                // Aucun fichier sélectionné
                fileStatus.classList.add('hidden');
            }
        }

        // Fonction pour afficher un message de succès
        function showSuccessMessage(message) {
            const successDiv = document.getElementById('successMessage');
            const successText = document.getElementById('successText');
            successText.textContent = message;
            successDiv.classList.remove('hidden');
            
            // Masquer après 5 secondes
            setTimeout(() => {
                successDiv.classList.add('hidden');
            }, 5000);
        }

        // Fonction pour afficher les erreurs
        function showErrors(errors) {
            const errorDiv = document.getElementById('errorMessages');
            const errorList = document.getElementById('errorList');
            
            errorList.innerHTML = '';
            errors.forEach(error => {
                const li = document.createElement('li');
                li.className = 'flex items-center';
                li.innerHTML = `<i class="fas fa-circle text-xs mr-2"></i>${error}`;
                errorList.appendChild(li);
            });
            
            errorDiv.classList.remove('hidden');
        }

        // Fonction pour masquer les erreurs
        function hideErrors() {
            const errorDiv = document.getElementById('errorMessages');
            errorDiv.classList.add('hidden');
        }

        // Validation basique
        function validateForm(formData) {
            const errors = [];
            
            if (!formData.get('nom').trim()) {
                errors.push('Le nom est obligatoire');
            }
            
            if (!formData.get('prenoms').trim()) {
                errors.push('Les prénoms sont obligatoires');
            }
            
            const email = formData.get('email').trim();
            if (!email) {
                errors.push('L\'email est obligatoire');
            } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                errors.push('Format d\'email invalide');
            }
            
            const password = formData.get('password');
            const passwordConfirmation = formData.get('password_confirmation');
            
            if (password && password !== passwordConfirmation) {
                errors.push('Les mots de passe ne correspondent pas');
            }
            
            if (password && password.length < 8) {
                errors.push('Le mot de passe doit contenir au moins 8 caractères');
            }
            
            return errors;
        }

        // Mettre à jour l'affichage du nom complet
        function updateFullName() {
            const nom = document.getElementById('nom').value;
            const prenoms = document.getElementById('prenoms').value;
            const fullNameElement = document.getElementById('userFullName');
            
            if (nom || prenoms) {
                fullNameElement.textContent = `${prenoms} ${nom}`.trim();
            }
        }

        // Gestion du formulaire
        document.addEventListener('DOMContentLoaded', function() {
            
            // Animation des éléments
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach((input, index) => {
                input.style.opacity = '0';
                input.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    input.style.transition = 'all 0.5s ease';
                    input.style.opacity = '1';
                    input.style.transform = 'translateY(0)';
                }, 50 * index);
            });

            // Écouter les changements de nom et prénoms
            document.getElementById('nom').addEventListener('input', updateFullName);
            document.getElementById('prenoms').addEventListener('input', updateFullName);            // Gestion de la soumission du formulaire
            const form = document.getElementById('profileForm');
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                hideErrors();
                
                const formData = new FormData(this);
                const errors = validateForm(formData);
                
                if (errors.length > 0) {
                    showErrors(errors);
                    return;
                }
                
                // Vérifier si un fichier a été sélectionné
                const fileInput = document.getElementById('profile_photo');
                const selectedFile = fileInput.files[0];
                
                let successMessage = 'Profil mis à jour avec succès!';
                if (selectedFile) {
                    successMessage += ` Photo "${selectedFile.name}" incluse dans la mise à jour.`;
                }
                
                const submitButton = document.getElementById('submitButton');
                const originalContent = submitButton.innerHTML;
                
                // Désactiver le bouton et changer son apparence
                submitButton.disabled = true;
                submitButton.innerHTML = '<i class="fas fa-circle-notch fa-spin mr-2"></i>Mise à jour en cours...';
                submitButton.className = 'flex-1 inline-flex items-center justify-center px-6 py-3 bg-gray-400 text-white font-medium rounded-lg cursor-not-allowed';
                
                // Simuler une requête (dans un vrai projet, vous feriez un appel AJAX ici)
                setTimeout(() => {
                    // Réactiver le bouton
                    submitButton.disabled = false;
                    submitButton.innerHTML = originalContent;
                    submitButton.className = 'flex-1 inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-primary-600 to-primary-700 text-white font-medium rounded-lg hover:from-primary-700 hover:to-primary-800 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 focus:outline-none focus:ring-4 focus:ring-primary-200';
                    
                    // Afficher le message de succès
                    showSuccessMessage(successMessage);
                    
                    // Scroll vers le haut pour voir le message
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }, 2000);
            });

            // Validation en temps réel
            inputs.forEach(input => {
                input.addEventListener('blur', function() {
                    const errorElement = this.parentNode.querySelector('.error-message');
                    const errorText = errorElement.querySelector('.error-text');
                    
                    // Réinitialiser les styles d'erreur
                    this.classList.remove('border-red-500', 'ring-2', 'ring-red-200');
                    errorElement.classList.add('hidden');
                    
                    // Validation spécifique par champ
                    if (this.name === 'email' && this.value) {
                        if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.value)) {
                            this.classList.add('border-red-500', 'ring-2', 'ring-red-200');
                            errorText.textContent = 'Format d\'email invalide';
                            errorElement.classList.remove('hidden');
                        }
                    }
                    
                    if ((this.name === 'nom' || this.name === 'prenoms') && !this.value.trim()) {
                        this.classList.add('border-red-500', 'ring-2', 'ring-red-200');
                        errorText.textContent = 'Ce champ est obligatoire';
                        errorElement.classList.remove('hidden');
                    }
                });
            });

            // Vérification de correspondance des mots de passe
            const passwordField = document.getElementById('password');
            const confirmPasswordField = document.getElementById('password_confirmation');
            
            function checkPasswordMatch() {
                const password = passwordField.value;
                const confirmPassword = confirmPasswordField.value;
                const errorElement = confirmPasswordField.parentNode.querySelector('.error-message');
                const errorText = errorElement.querySelector('.error-text');
                
                if (password && confirmPassword && password !== confirmPassword) {
                    confirmPasswordField.classList.add('border-red-500', 'ring-2', 'ring-red-200');
                    errorText.textContent = 'Les mots de passe ne correspondent pas';
                    errorElement.classList.remove('hidden');
                } else {
                    confirmPasswordField.classList.remove('border-red-500', 'ring-2', 'ring-red-200');
                    errorElement.classList.add('hidden');
                }
            }
            
            passwordField.addEventListener('input', checkPasswordMatch);
            confirmPasswordField.addEventListener('input', checkPasswordMatch);
        });

        // Gestion des raccourcis clavier
        document.addEventListener('keydown', function(e) {
            // Ctrl+S pour sauvegarder
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                document.getElementById('profileForm').dispatchEvent(new Event('submit'));
            }
        });
    </script>
</body>
</html>
